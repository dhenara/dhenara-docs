"use strict";(self.webpackChunkdhenara_docs=self.webpackChunkdhenara_docs||[]).push([[8478],{6214:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"dhenara-ai/samples/text-gen/streaming","title":"Streaming","description":"This example shows how to consume streaming responses.","source":"@site/docs/dhenara-ai/samples/text-gen/streaming.md","sourceDirName":"dhenara-ai/samples/text-gen","slug":"/dhenara-ai/samples/text-gen/streaming","permalink":"/dhenara-ai/samples/text-gen/streaming","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Streaming"},"sidebar":"dhenaraAiSidebar","previous":{"title":"Async Text Generation","permalink":"/dhenara-ai/samples/text-gen/text-gen-async"},"next":{"title":"Image Generation","permalink":"/dhenara-ai/samples/image-gen/"}}');var s=t(4848),o=t(8453);const r={title:"Streaming"},i="Streaming",d={},l=[];function c(e){const n={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"streaming",children:"Streaming"})}),"\n",(0,s.jsx)(n.p,{children:"This example shows how to consume streaming responses."}),"\n",(0,s.jsxs)(n.p,{children:["For the full runnable script (with richer console rendering), see ",(0,s.jsx)(n.code,{children:"packages/dhenara_ai/examples/02_text_streaming.py"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import os\n\nfrom dhenara.ai import AIModelClient\nfrom dhenara.ai.types import (\n    AIModelAPI,\n    AIModelAPIProviderEnum,\n    AIModelCallConfig,\n    AIModelEndpoint,\n    ChatResponseChunk,\n)\nfrom dhenara.ai.types.genai.foundation_models.anthropic.chat import ClaudeSonnet45\nfrom dhenara.ai.types.shared import SSEErrorResponse, SSEEventType, SSEResponse\n\n# 1. Create an API\n# This can be used to create multiple model endpoints for the same API provider\napi = AIModelAPI(\n    provider=AIModelAPIProviderEnum.ANTHROPIC,\n    api_key=os.environ["ANTHROPIC_API_KEY"],\n)\n\n# 2. Select or create an AI model\n# You can either use the foundation models as it is, or create your own models\nmodel = ClaudeSonnet45\n\n# Create the model endpoint\nmodel_endpoint = AIModelEndpoint(api=api, ai_model=model)\n\n# Create the client\nclient = AIModelClient(\n    model_endpoint=model_endpoint,\n    config=AIModelCallConfig(\n        streaming=True,\n        reasoning=False,\n        max_output_tokens=400,\n    ),\n    is_async=False,  # Sync mode/ async mode\n)\n\n\nresponse = client.generate(\n    prompt="Explain quantum computing in one paragraph.",\n    instructions=["Be concise."],\n)\n\n\ndef print_text_deltas(chunk: ChatResponseChunk) -> None:\n    for choice_delta in chunk.choice_deltas:\n        for content_delta in choice_delta.content_deltas or []:\n            text = content_delta.get_text_delta()\n            if text:\n                print(text, end="", flush=True)\n\n\nfor chunk, final_response in response.stream_generator:\n    if chunk is not None:\n        if isinstance(chunk, SSEErrorResponse):\n            raise RuntimeError(f"{chunk.data.error_code}: {chunk.data.message}")\n\n        if isinstance(chunk, SSEResponse) and chunk.event == SSEEventType.TOKEN_STREAM:\n            print_text_deltas(chunk.data)\n\n    if final_response is not None:\n        assert final_response.chat_response\n        print("\\n\\n---\\nFinal consolidated response:\\n")\n        print(final_response.chat_response.text())\n        print("\\nUsage:", final_response.chat_response.usage)\n\n'})})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>i});var a=t(6540);const s={},o=a.createContext(s);function r(e){const n=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(o.Provider,{value:n},e.children)}}}]);