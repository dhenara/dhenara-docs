"use strict";(self.webpackChunkdhenara_docs=self.webpackChunkdhenara_docs||[]).push([[9297],{6364:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"dhenara-agent/advanced-guides/implementation-flow","title":"Implementation Flow","description":"Overview","source":"@site/docs/dhenara-agent/advanced-guides/implementation-flow.md","sourceDirName":"dhenara-agent/advanced-guides","slug":"/dhenara-agent/advanced-guides/implementation-flow","permalink":"/dhenara-agent/advanced-guides/implementation-flow","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Implementation Flow"},"sidebar":"dhenaraAgentSidebar","previous":{"title":"Input Handling","permalink":"/dhenara-agent/advanced-guides/input-handling"},"next":{"title":"core-api","permalink":"/dhenara-agent/api-reference/core-api"}}');var o=t(4848),s=t(8453);const r={title:"Implementation Flow"},a="Implementation Flow",l={},d=[{value:"Overview",id:"overview",level:2},{value:"Core Components",id:"core-components",level:2},{value:"Detailed Architecture",id:"detailed-architecture",level:2},{value:"Repository Analysis",id:"repository-analysis",level:3},{value:"Code Generation",id:"code-generation",level:3},{value:"File Operations",id:"file-operations",level:3},{value:"Input Handling Architecture",id:"input-handling-architecture",level:2},{value:"TaskImplementation Structure",id:"taskimplementation-structure",level:2},{value:"Flow Execution Process",id:"flow-execution-process",level:2},{value:"Advanced Features",id:"advanced-features",level:2},{value:"Multi-Model Support",id:"multi-model-support",level:3},{value:"Custom Operation Collection",id:"custom-operation-collection",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Conclusion",id:"conclusion",level:2}];function c(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"implementation-flow",children:"Implementation Flow"})}),"\n",(0,o.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsx)(n.p,{children:"The Implementation Flow in Dhenara Agent DSL (DAD) is a specialized workflow designed for code generation, analysis, and\nautomated implementation of software changes. This document details the architecture of the implementation flow, its\ncomponents, and how they work together to deliver robust code changes."}),"\n",(0,o.jsx)(n.h2,{id:"core-components",children:"Core Components"}),"\n",(0,o.jsx)(n.p,{children:"The Implementation Flow consists of three main components working in sequence:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Repository Analysis"}),": Analyzes the code repository to understand its structure and content"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Code Generation"}),": Uses AI models to generate detailed implementation plans based on requirements and repository\nanalysis"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"File Operations"}),": Implements the generated code changes in the repository"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"detailed-architecture",children:"Detailed Architecture"}),"\n",(0,o.jsx)(n.h3,{id:"repository-analysis",children:"Repository Analysis"}),"\n",(0,o.jsxs)(n.p,{children:["The repository analysis is performed by the ",(0,o.jsx)(n.code,{children:"FolderAnalyzerNode"})," which examines the codebase structure and contents:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'implementation_flow.node(\n    "dynamic_repo_analysis",\n    FolderAnalyzerNode(\n        pre_events=[EventType.node_input_required],\n        settings=None,  # Dynamic settings provided through event handler\n    ),\n)\n'})}),"\n",(0,o.jsx)(n.p,{children:"Key aspects of the repository analysis:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Dynamic Configuration"}),": Analysis operations are configured at runtime through input handlers"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Selective Analysis"}),": Focuses on relevant parts of the codebase using include/exclude patterns"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Content Extraction"}),": Extracts file contents for deeper analysis by AI models"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Structured Output"}),": Produces a structured representation of the repository for downstream processing"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"code-generation",children:"Code Generation"}),"\n",(0,o.jsxs)(n.p,{children:["The code generation is handled by the ",(0,o.jsx)(n.code,{children:"AIModelNode"})," which leverages large language models to generate implementation\nplans:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'implementation_flow.node(\n    "code_generator",\n    AIModelNode(\n        resources=ResourceConfigItem.with_models(model_name),\n        pre_events=[EventType.node_input_required],\n        settings=AIModelNodeSettings(\n            system_instructions=[\n                "You are a professional code implementation agent.",\n                "Your task is to generate the exact file operations necessary to implement requested changes.",\n                # Additional instructions...\n            ],\n            prompt=Prompt.with_dad_text(\n                text=(\n                    "Implement the following batch of code changes:\\n\\n"\n                    "Task: $var{task_description} \\n"\n                    "Context Files info: $hier{dynamic_repo_analysis}.outcome.structured\\n\\n"\n                    "Return a TaskImplementation object."\n                ),\n            ),\n            model_call_config=AIModelCallConfig(\n                structured_output=TaskImplementation,\n                max_output_tokens=8000,\n            ),\n        ),\n    ),\n)\n'})}),"\n",(0,o.jsx)(n.p,{children:"Key aspects of code generation:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Model Selection"}),": Supports multiple AI models with fallback options"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Structured Output"}),": Generates a ",(0,o.jsx)(n.code,{children:"TaskImplementation"})," object with specific file operations"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Context-Aware Generation"}),": Uses the repository analysis as context for generation"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Task-Specific Instructions"}),": Custom system instructions focused on code implementation"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"file-operations",children:"File Operations"}),"\n",(0,o.jsxs)(n.p,{children:["The file operations are executed by the ",(0,o.jsx)(n.code,{children:"FileOperationNode"})," which implements the changes specified by the code\ngenerator:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'implementation_flow.node(\n    "code_generator_file_ops",\n    FileOperationNode(\n        settings=FileOperationNodeSettings(\n            base_directory=repo_dir,\n            operations_template=ObjectTemplate(\n                expression="$hier{code_generator}.outcome.structured.file_operations"\n            ),\n            stage=True,\n            commit=False,\n            commit_message="$var{run_id}: Implemented plan step",\n        ),\n    ),\n)\n'})}),"\n",(0,o.jsx)(n.p,{children:"Key aspects of file operations:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Operation Types"}),": Supports create, edit, delete, move, and other file operations"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Git Integration"}),": Can stage and commit changes to version control"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Dynamic Operations"}),": Uses a template to reference operations generated by the AI model"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Base Directory"}),": All operations are relative to a configured base directory"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"input-handling-architecture",children:"Input Handling Architecture"}),"\n",(0,o.jsx)(n.p,{children:"The implementation flow uses an event-driven architecture for handling inputs:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'async def singleshot_autocoder_input_handler(event: NodeInputRequiredEvent):\n    if event.node_type == FlowNodeTypeEnum.ai_model_call:\n        # AI model node input handling\n        available_models = [*models]\n        selected_model_idx = await get_menu_choice(available_models, "Select an AI model:")\n        selected_model = available_models[selected_model_idx]\n\n        node_input = AIModelNodeInput(\n            resources_override=ResourceConfigItem.with_model(selected_model),\n        )\n\n        if event.node_id == "code_generator":\n            task_description = await async_input("Enter your task_description: ")\n            node_input.prompt_variables = {"task_description": task_description}\n            event.input = node_input\n            event.handled = True\n\n    elif event.node_type == FlowNodeTypeEnum.folder_analyzer:\n        # Folder analyzer node input handling\n        if event.node_id == "dynamic_repo_analysis":\n            operations = []\n            while True:\n                operation = await get_operation_input()\n                operations.append(operation)\n                if not await get_yes_no_input("Add another analysis operation?", False):\n                    break\n\n            event.input = FolderAnalyzerNodeInput(\n                settings_override=FolderAnalyzerSettings(\n                    base_directory=repo_dir,\n                    operations=operations,\n                )\n            )\n            event.handled = True\n'})}),"\n",(0,o.jsx)(n.p,{children:"Key aspects of input handling:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Event-Driven"}),": Input is requested through events when nodes need configuration"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Interactive UI"}),": Uses interactive prompts to collect user input"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Type-Specific Handling"}),": Different handling based on node type and ID"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Dynamic Configuration"}),": Builds configuration objects based on user input"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"taskimplementation-structure",children:"TaskImplementation Structure"}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"TaskImplementation"})," object is the core data structure for code changes:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'class TaskImplementation(BaseModel):\n    """Contains the concrete file operations to implement a specific task of the plan.\n    This is the output generated after analyzing the context specified in the TaskSpec."""\n\n    file_operations: list[FileOperation]  # Ordered list of file operations to execute\n    execution_commands: list[dict] | None = None  # Optional shell commands to run after file operations\n    verification_commands: list[dict] | None = None  # Optional commands to verify the changes\n    task_id: str | None = None  # ID of the corresponding TaskSpec\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"FileOperation"})," objects specify exact changes to make:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'class FileOperation(BaseModel):\n    """Represents a single file operation for the filesystem"""\n\n    type: str  # Operation type (create_file, edit_file, delete_file, etc.)\n    path: str | None = None  # Path to the target file or directory\n    content: str | None = None  # Content for file creation operations\n    edits: list[EditOperation] | None = None  # List of edits to apply to a file\n    # Other fields...\n'})}),"\n",(0,o.jsx)(n.h2,{id:"flow-execution-process",children:"Flow Execution Process"}),"\n",(0,o.jsx)(n.p,{children:"The implementation flow execution follows this sequence:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Initialization"}),": The flow is defined with its nodes and connections"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Analysis Phase"}),": Repository analysis collects information about the codebase"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Generation Phase"}),": AI model generates detailed implementation steps"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Implementation Phase"}),": File operations are executed based on the AI-generated plan"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Verification"}),": Optional verification to confirm changes work as expected"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"advanced-features",children:"Advanced Features"}),"\n",(0,o.jsx)(n.h3,{id:"multi-model-support",children:"Multi-Model Support"}),"\n",(0,o.jsx)(n.p,{children:"The implementation flow supports multiple AI models for code generation:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'# Define available models\nmodels = [\n    "claude-3-7-sonnet",\n    "gpt-4.1-nano",\n    "gpt-4.1-nano",\n    "claude-3-5-haiku",\n    "gemini-2.0-flash",\n    "gemini-2.0-flash-lite"\n]\n\n# Allow selection at runtime\nselected_model = available_models[await get_menu_choice(available_models)]\n'})}),"\n",(0,o.jsx)(n.p,{children:"This provides flexibility to choose the best model for specific implementation tasks."}),"\n",(0,o.jsx)(n.h3,{id:"custom-operation-collection",children:"Custom Operation Collection"}),"\n",(0,o.jsx)(n.p,{children:"The implementation flow allows for custom collection of analysis operations:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-python",children:'# Dynamic collection of analysis operations\noperations = []\nwhile True:\n    operation = await get_operation_input()\n    operations.append(operation)\n    if not await get_yes_no_input("Add another analysis operation?", False):\n        break\n'})}),"\n",(0,o.jsx)(n.p,{children:"This enables fine-grained control over what parts of the repository to analyze."}),"\n",(0,o.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Clear Task Description"}),": Provide detailed, specific task descriptions for accurate code generation"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Strategic Repository Analysis"}),": Focus analysis on relevant parts of the codebase to improve performance"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Model Selection"}),": Choose appropriate models based on the complexity of the implementation task"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Verification"}),": Use verification commands to confirm changes work as expected"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Incremental Implementation"}),": For complex changes, break them into smaller, manageable tasks"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"conclusion",children:"Conclusion"}),"\n",(0,o.jsx)(n.p,{children:"The Implementation Flow architecture in DAD provides a powerful, flexible system for automated code generation and\nimplementation. By combining repository analysis, AI-powered code generation, and automatic file operations, it enables\nefficient implementation of complex code changes while maintaining high quality and consistency."})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var i=t(6540);const o={},s=i.createContext(o);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);