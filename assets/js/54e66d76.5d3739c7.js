"use strict";(self.webpackChunkdhenara_docs=self.webpackChunkdhenara_docs||[]).push([[9296],{3265:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"dhenara-ai/guides/tools-and-function-calling","title":"Tools & Function Calling","description":"Dhenara normalizes tool/function calling across providers and keeps the message history structure correct (tool calls and tool results must appear in the right order).","source":"@site/docs/dhenara-ai/guides/tools-and-function-calling.md","sourceDirName":"dhenara-ai/guides","slug":"/dhenara-ai/guides/tools-and-function-calling","permalink":"/dhenara-ai/guides/tools-and-function-calling","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Tools & Function Calling"},"sidebar":"dhenaraAiSidebar","previous":{"title":"Structured Output (Pydantic)","permalink":"/dhenara-ai/guides/structured-output"},"next":{"title":"Artifacts & Debugging","permalink":"/dhenara-ai/guides/artifacts-and-debugging"}}');var a=t(4848),l=t(8453);const i={title:"Tools & Function Calling"},s="Tools & Function Calling",r={},c=[{value:"1) Define tools",id:"1-define-tools",level:2},{value:"Option A: explicit schema",id:"option-a-explicit-schema",level:3},{value:"Option B: from a Python callable",id:"option-b-from-a-python-callable",level:3},{value:"2) Call the model with tools enabled",id:"2-call-the-model-with-tools-enabled",level:2},{value:"3) Execute tool calls and append tool results",id:"3-execute-tool-calls-and-append-tool-results",level:2},{value:"Provider nuance: reasoning + tools",id:"provider-nuance-reasoning--tools",level:2},{value:"See runnable examples",id:"see-runnable-examples",level:2}];function d(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"tools--function-calling",children:"Tools & Function Calling"})}),"\n",(0,a.jsxs)(n.p,{children:["Dhenara normalizes tool/function calling across providers and keeps the ",(0,a.jsx)(n.em,{children:"message history structure correct"})," (tool calls and tool results must appear in the right order)."]}),"\n",(0,a.jsx)(n.p,{children:"This guide shows the minimal pattern. For a full multi-turn implementation, use the examples linked at the end."}),"\n",(0,a.jsx)(n.h2,{id:"1-define-tools",children:"1) Define tools"}),"\n",(0,a.jsx)(n.p,{children:"You can define tools two ways:"}),"\n",(0,a.jsx)(n.h3,{id:"option-a-explicit-schema",children:"Option A: explicit schema"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from dhenara.ai.types.genai.dhenara.request import (\n    FunctionDefinition,\n    FunctionParameter,\n    FunctionParameters,\n    ToolDefinition,\n)\n\nweather_tool = ToolDefinition(\n    function=FunctionDefinition(\n        name="get_weather",\n        description="Get the current weather for a location",\n        parameters=FunctionParameters(\n            type="object",\n            required=["location"],\n            properties={\n                "location": FunctionParameter(type="string", description="City, e.g. San Francisco"),\n                "unit": FunctionParameter(\n                    type="string",\n                    description="celsius or fahrenheit",\n                    allowed_values=["celsius", "fahrenheit"],\n                ),\n            },\n        ),\n    )\n)\n'})}),"\n",(0,a.jsx)(n.h3,{id:"option-b-from-a-python-callable",children:"Option B: from a Python callable"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from typing import Any\n\nfrom dhenara.ai.types import ToolDefinition\n\n\ndef get_weather(location: str, unit: str = "celsius") -> dict[str, Any]:\n    """Get the current weather in a given location.\n\n    :param location: The city and state, e.g. San Francisco, CA\n    :param unit: celsius or fahrenheit\n    """\n    return {"location": location, "unit": unit, "temperature": 22}\n\n\nget_weather_tool = ToolDefinition.from_callable(get_weather)\n'})}),"\n",(0,a.jsx)(n.h2,{id:"2-call-the-model-with-tools-enabled",children:"2) Call the model with tools enabled"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'from dhenara.ai import AIModelClient\nfrom dhenara.ai.types import AIModelCallConfig, ToolChoice\n\nclient = AIModelClient(\n    model_endpoint=endpoint,\n    config=AIModelCallConfig(\n        tools=[get_weather_tool],\n        tool_choice=ToolChoice(type="zero_or_more"),\n        streaming=False,\n    ),\n)\n\nresp = client.generate(messages=messages, instructions=["Use tools when appropriate."])\nchat = resp.chat_response\n'})}),"\n",(0,a.jsx)(n.h2,{id:"3-execute-tool-calls-and-append-tool-results",children:"3) Execute tool calls and append tool results"}),"\n",(0,a.jsxs)(n.p,{children:["Tool calls arrive as normalized content items on ",(0,a.jsx)(n.code,{children:"chat.choices[0].contents"}),"."]}),"\n",(0,a.jsx)(n.p,{children:"In a multi-turn loop, the correct pattern is:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["Append the assistant response as a single message (",(0,a.jsx)(n.code,{children:"chat.to_message_item()"}),")"]}),"\n",(0,a.jsx)(n.li,{children:"Execute each tool call"}),"\n",(0,a.jsxs)(n.li,{children:["Append a ",(0,a.jsx)(n.code,{children:"ToolCallResult"})," message"]}),"\n"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-python",children:'import json\n\nfrom dhenara.ai.types.genai.dhenara.request import ToolCallResult\n\n# 1) Preserve assistant message (including tool calls)\nassistant_msg = chat.to_message_item()\nif assistant_msg:\n    messages.append(assistant_msg)\n\n# 2) Execute tool calls\nfor content in chat.choices[0].contents or []:\n    if content.type == "tool_call" and content.tool_call:\n        call = content.tool_call\n        args = call.arguments\n        result = TOOL_REGISTRY[call.name](**args)\n\n        # 3) Append tool result with the same call_id\n        messages.append(\n            ToolCallResult(\n                call_id=call.call_id,\n                name=call.name,\n                output=result,\n            )\n        )\n'})}),"\n",(0,a.jsx)(n.h2,{id:"provider-nuance-reasoning--tools",children:"Provider nuance: reasoning + tools"}),"\n",(0,a.jsx)(n.p,{children:"Some providers have constraints when combining \u201cthinking/reasoning\u201d with tool calling in multi-turn conversations."}),"\n",(0,a.jsx)(n.p,{children:"If you enable reasoning and tools together, ensure you preserve the full assistant message content in history (including reasoning/thinking blocks where required), or disable reasoning for those turns."}),"\n",(0,a.jsx)(n.h2,{id:"see-runnable-examples",children:"See runnable examples"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"packages/dhenara_ai/examples/16_multi_turn_with_tools_and_messages_api.py"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"packages/dhenara_ai/examples/18_streaming_multi_turn_with_tools_and_structured_output.py"})}),"\n",(0,a.jsx)(n.li,{children:(0,a.jsx)(n.code,{children:"packages/dhenara_ai/examples/20_fn_calling.py"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>s});var o=t(6540);const a={},l=o.createContext(a);function i(e){const n=o.useContext(l);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),o.createElement(l.Provider,{value:n},e.children)}}}]);